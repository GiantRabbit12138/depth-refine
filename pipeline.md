```markdown
1. 输入数据：
   - 多视角RGB图像 I_i
   - 多视角初始深度图 D_i
   - 相机参数 P_i
   - 真实深度图 D_gt

2. 分支1：基于RGB的代价体
   - 2D特征提取（FPN）
   - 特征翘曲与聚合
   - 计算方差得到3D代价体

3. 分支2：基于深度的先验
   - 2D特征提取（ResNet）
   - 特征溅射/反投影
   - 置入3D空间得到单目深度特征

4. 融合与回归
   - 特征体积融合
   - 3D U-Net正则化
   - Soft Argmax回归最终深度

5. 损失计算
   - 计算损失（L1 + Smoothness）
   - 反向传播优化各分支